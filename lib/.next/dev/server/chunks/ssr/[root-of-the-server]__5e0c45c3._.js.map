{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/darrel/School/Cryptography/SemProject1/Proj1_Starter/lib/app/ui/Field.jsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport Image from \"next/image\";\n\nexport default function Field({ domain, password, deleteEntry }) {\n  const [visible, setVisible] = useState(false);\n  return (\n    <div className=\"flex flex-row py-3 items-center\">\n      <label className=\"w-1/3 pr-10 truncate\">{domain}</label>\n      <div className=\"w-2/3 flex flex-row items-center space-x-3\">\n        <input\n          type={visible ? \"text\" : \"password\"}\n          value={password}\n          readOnly\n          className=\"rounded-md px-2 py-2 bg-gray-100 border border-gray-200 w-full\"\n        />\n        <button\n          onClick={() => {\n            setVisible(!visible);\n          }}\n        >\n          {visible ? (\n            <Image src=\"/eye.svg\" alt=\"visible\" width={22} height={22} />\n          ) : (\n            <Image src=\"/eye-closed.svg\" alt=\"visible\" width={25} height={25} />\n          )}\n        </button>\n        <button\n          onClick={() => {\n            deleteEntry(domain);\n          }}\n        >\n          <Image src=\"/delete.svg\" alt=\"visible\" width={25} height={25} />\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE;IAC7D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAM,WAAU;0BAAwB;;;;;;0BACzC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAM,UAAU,SAAS;wBACzB,OAAO;wBACP,QAAQ;wBACR,WAAU;;;;;;kCAEZ,8OAAC;wBACC,SAAS;4BACP,WAAW,CAAC;wBACd;kCAEC,wBACC,8OAAC,wIAAK;4BAAC,KAAI;4BAAW,KAAI;4BAAU,OAAO;4BAAI,QAAQ;;;;;iDAEvD,8OAAC,wIAAK;4BAAC,KAAI;4BAAkB,KAAI;4BAAU,OAAO;4BAAI,QAAQ;;;;;;;;;;;kCAGlE,8OAAC;wBACC,SAAS;4BACP,YAAY;wBACd;kCAEA,cAAA,8OAAC,wIAAK;4BAAC,KAAI;4BAAc,KAAI;4BAAU,OAAO;4BAAI,QAAQ;;;;;;;;;;;;;;;;;;;;;;;AAKpE"}},
    {"offset": {"line": 117, "column": 0}, "map": {"version":3,"sources":["file:///home/darrel/School/Cryptography/SemProject1/Proj1_Starter/lib/lib.js"],"sourcesContent":["\"use strict\";\n\nconst { getRandomValues } = require(\"crypto\");\n\n/**\n * Converts a plaintext string into a buffer for use in SubtleCrypto functions.\n * @param {string} str - A plaintext string\n * @returns {Buffer} A buffer representation for use in SubtleCrypto functions\n */\nfunction stringToBuffer(str) {\n  return Buffer.from(str);\n}\n\n/**\n * Converts a buffer object representing string data back into a string\n * @param {BufferSource} buf - A buffer containing string data\n * @returns {string} The original string\n */\nfunction bufferToString(buf) {\n  return Buffer.from(buf).toString();\n}\n\n/**\n * Converts a buffer to a Base64 string which can be used as a key in a map and\n * can be easily serialized.\n * @param {BufferSource} buf - A buffer-like object\n * @returns {string} A Base64 string representing the bytes in the buffer\n */\nfunction encodeBuffer(buf) {\n  return Buffer.from(buf).toString(\"base64\");\n}\n\n/**\n * Converts a Base64 string back into a buffer\n * @param {string} base64 - A Base64 string representing a buffer\n * @returns {Buffer} A Buffer object\n */\nfunction decodeBuffer(base64) {\n  return Buffer.from(base64, \"base64\");\n}\n\n/**\n * Generates a buffer of random bytes\n * @param {number} len - The number of random bytes\n * @returns {Uint8Array} A buffer of `len` random bytes\n */\nfunction getRandomBytes(len) {\n  return crypto.getRandomValues(new Uint8Array(len));\n}\n\nmodule.exports = {\n  stringToBuffer,\n  bufferToString,\n  encodeBuffer,\n  decodeBuffer,\n  getRandomBytes,\n};\n"],"names":[],"mappings":"AAEA,MAAM,EAAE,eAAe,EAAE;AAEzB;;;;CAIC,GACD,SAAS,eAAe,GAAG;IACzB,OAAO,OAAO,IAAI,CAAC;AACrB;AAEA;;;;CAIC,GACD,SAAS,eAAe,GAAG;IACzB,OAAO,OAAO,IAAI,CAAC,KAAK,QAAQ;AAClC;AAEA;;;;;CAKC,GACD,SAAS,aAAa,GAAG;IACvB,OAAO,OAAO,IAAI,CAAC,KAAK,QAAQ,CAAC;AACnC;AAEA;;;;CAIC,GACD,SAAS,aAAa,MAAM;IAC1B,OAAO,OAAO,IAAI,CAAC,QAAQ;AAC7B;AAEA;;;;CAIC,GACD,SAAS,eAAe,GAAG;IACzB,OAAO,OAAO,eAAe,CAAC,IAAI,WAAW;AAC/C;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;AACF"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///home/darrel/School/Cryptography/SemProject1/Proj1_Starter/lib/password-manager-online.js"],"sourcesContent":["\"use strict\";\n/********* External Imports ********/\nconst {\n  stringToBuffer,\n  bufferToString,\n  encodeBuffer,\n  decodeBuffer,\n  getRandomBytes,\n} = require(\"./lib\");\nvar subtle = window.crypto.subtle;\n/********* Constants ********/\nconst PBKDF2_ITERATIONS = 100000; // number of iterations for PBKDF2 algorithm\nconst MAX_PASSWORD_LENGTH = 64; // we can assume no password is longer than this many characters\n/********* Implementation ********/\nclass Keychain {\n  /**\n   * Initializes the keychain using the provided information. Note that external\n   * users should likely never invoke the constructor directly and instead use\n   * either Keychain.init or Keychain.load.\n   * Arguments:\n   * You may design the constructor with any parameters you would like.\n   * Return Type: void\n   */\n  constructor() {\n    this.data = {\n      kvs: {},\n      salt: null,\n      verifyTag: null,\n    };\n    this.secrets = {\n      aesKey: null,\n      domainHmacKey: null,\n    };\n  }\n  /**\n   * Creates an empty keychain with the given password.\n   *\n   * Arguments:\n   * password: string\n   * Return Type: void\n   */\n  static async init(password) {\n    let kc = new Keychain();\n    let salt = getRandomBytes(16);\n    kc.data.salt = encodeBuffer(salt);\n    let rawKey = await subtle.importKey(\n      \"raw\",\n      stringToBuffer(password),\n      \"PBKDF2\",\n      false,\n      [\"deriveKey\"],\n    );\n    let masterHmacKey = await subtle.deriveKey(\n      {\n        name: \"PBKDF2\",\n        salt: salt,\n        iterations: PBKDF2_ITERATIONS,\n        hash: \"SHA-256\",\n      },\n      rawKey,\n      { name: \"HMAC\", hash: \"SHA-256\", length: 256 },\n      false,\n      [\"sign\", \"verify\"],\n    );\n    let aesKeyMaterial = await subtle.sign(\n      \"HMAC\",\n      masterHmacKey,\n      stringToBuffer(\"aes-key\"),\n    );\n    kc.secrets.aesKey = await subtle.importKey(\n      \"raw\",\n      aesKeyMaterial,\n      \"AES-GCM\",\n      false,\n      [\"encrypt\", \"decrypt\"],\n    );\n    let domainHmacKeyMaterial = await subtle.sign(\n      \"HMAC\",\n      masterHmacKey,\n      stringToBuffer(\"domain-key\"),\n    );\n    kc.secrets.domainHmacKey = await subtle.importKey(\n      \"raw\",\n      domainHmacKeyMaterial,\n      { name: \"HMAC\", hash: \"SHA-256\", length: 256 },\n      false,\n      [\"sign\"],\n    );\n    let verifyKeyMaterial = await subtle.sign(\n      \"HMAC\",\n      masterHmacKey,\n      stringToBuffer(\"verify-key\"),\n    );\n    let verifyKey = await subtle.importKey(\n      \"raw\",\n      verifyKeyMaterial,\n      { name: \"HMAC\", hash: \"SHA-256\", length: 256 },\n      false,\n      [\"sign\"],\n    );\n    let verifyTag = await subtle.sign(\n      \"HMAC\",\n      verifyKey,\n      stringToBuffer(\"verify\"),\n    );\n    kc.data.verifyTag = encodeBuffer(verifyTag);\n    return kc;\n  }\n  /**\n   * Loads the keychain state from the provided representation (repr). The\n   * repr variable will contain a JSON encoded serialization of the contents\n   * of the KVS (as returned by the dump function). The trustedDataCheck\n   * is an *optional* SHA-256 checksum that can be used to validate the\n   * integrity of the contents of the KVS. If the checksum is provided and the\n   * integrity check fails, an exception should be thrown. You can assume that\n   * the representation passed to load is well-formed (i.e., it will be\n   * a valid JSON object).Returns a Keychain object that contains the data\n   * from repr.\n   *\n   * Arguments:\n   * password: string\n   * repr: string\n   * trustedDataCheck: string\n   * Return Type: Keychain\n   */\n  static async load(password, repr, trustedDataCheck) {\n    let hashBuf = await subtle.digest(\"SHA-256\", stringToBuffer(repr));\n    let computedCheck = encodeBuffer(hashBuf);\n    if (trustedDataCheck !== undefined && trustedDataCheck !== computedCheck) {\n      throw \"Integrity check failed\";\n    }\n    let data = JSON.parse(repr);\n    let kc = new Keychain();\n    kc.data = data;\n    let salt = decodeBuffer(data.salt);\n    let rawKey = await subtle.importKey(\n      \"raw\",\n      stringToBuffer(password),\n      \"PBKDF2\",\n      false,\n      [\"deriveKey\"],\n    );\n    let masterHmacKey = await subtle.deriveKey(\n      {\n        name: \"PBKDF2\",\n        salt: salt,\n        iterations: PBKDF2_ITERATIONS,\n        hash: \"SHA-256\",\n      },\n      rawKey,\n      { name: \"HMAC\", hash: \"SHA-256\", length: 256 },\n      false,\n      [\"sign\", \"verify\"],\n    );\n    let aesKeyMaterial = await subtle.sign(\n      \"HMAC\",\n      masterHmacKey,\n      stringToBuffer(\"aes-key\"),\n    );\n    kc.secrets.aesKey = await subtle.importKey(\n      \"raw\",\n      aesKeyMaterial,\n      \"AES-GCM\",\n      false,\n      [\"encrypt\", \"decrypt\"],\n    );\n    let domainHmacKeyMaterial = await subtle.sign(\n      \"HMAC\",\n      masterHmacKey,\n      stringToBuffer(\"domain-key\"),\n    );\n    kc.secrets.domainHmacKey = await subtle.importKey(\n      \"raw\",\n      domainHmacKeyMaterial,\n      { name: \"HMAC\", hash: \"SHA-256\", length: 256 },\n      false,\n      [\"sign\"],\n    );\n    let verifyKeyMaterial = await subtle.sign(\n      \"HMAC\",\n      masterHmacKey,\n      stringToBuffer(\"verify-key\"),\n    );\n    let verifyKey = await subtle.importKey(\n      \"raw\",\n      verifyKeyMaterial,\n      { name: \"HMAC\", hash: \"SHA-256\", length: 256 },\n      false,\n      [\"sign\"],\n    );\n    let verifyTag = await subtle.sign(\n      \"HMAC\",\n      verifyKey,\n      stringToBuffer(\"verify\"),\n    );\n    let computedVerifyTag = encodeBuffer(verifyTag);\n    if (computedVerifyTag !== kc.data.verifyTag) {\n      throw \"Invalid password\";\n    }\n    return kc;\n  }\n  /**\n   * Returns a JSON serialization of the contents of the keychain that can be\n   * loaded back using the load function. The return value should consist of\n   * an array of two strings:\n   * arr[0] = JSON encoding of password manager\n   * arr[1] = SHA-256 checksum (as a string)\n   * As discussed in the handout, the first element of the array should contain\n   * all of the data in the password manager. The second element is a SHA-256\n   * checksum computed over the password manager to preserve integrity.\n   *\n   * Return Type: array\n   */\n  async dump() {\n    let ser = JSON.stringify(this.data);\n    let hashBuf = await subtle.digest(\"SHA-256\", stringToBuffer(ser));\n    let checksum = encodeBuffer(hashBuf);\n    return [ser, checksum];\n  }\n  /**\n   * Fetches the data (as a string) corresponding to the given domain from the KVS.\n   * If there is no entry in the KVS that matches the given domain, then return\n   * null.\n   *\n   * Arguments:\n   * name: string\n   * Return Type: Promise<string>\n   */\n  async get(name) {\n    let domainBuf = stringToBuffer(name);\n    let hashedBuf = await subtle.sign(\n      \"HMAC\",\n      this.secrets.domainHmacKey,\n      domainBuf,\n    );\n    let hashed = encodeBuffer(hashedBuf);\n    if (!(hashed in this.data.kvs)) {\n      return null;\n    }\n    let entry = this.data.kvs[hashed];\n    let iv = decodeBuffer(entry.iv);\n    let ct = decodeBuffer(entry.ct);\n    try {\n      let decrypted = await subtle.decrypt(\n        { name: \"AES-GCM\", iv: iv, additionalData: domainBuf, tagLength: 128 },\n        this.secrets.aesKey,\n        ct,\n      );\n      let padded = new Uint8Array(decrypted);\n      let len = padded[0];\n      let pwBuf = padded.slice(1, 1 + len);\n      return bufferToString(pwBuf.buffer);\n    } catch (e) {\n      throw \"Tampering detected\";\n    }\n  }\n  /**\n   * Inserts the domain and associated data into the KVS. If the domain is\n   * already in the password manager, this method should update its value. If\n   * not, create a new entry in the password manager.\n   *\n   * Arguments:\n   * name: string\n   * value: string\n   * Return Type: void\n   */\n  async set(name, value) {\n    if (value.length > MAX_PASSWORD_LENGTH) {\n      throw \"Password too long\";\n    }\n    let domainBuf = stringToBuffer(name);\n    let hashedBuf = await subtle.sign(\n      \"HMAC\",\n      this.secrets.domainHmacKey,\n      domainBuf,\n    );\n    let hashed = encodeBuffer(hashedBuf);\n    let padded = new Uint8Array(1 + MAX_PASSWORD_LENGTH);\n    padded[0] = value.length;\n    let pwBuf = stringToBuffer(value);\n    padded.set(new Uint8Array(pwBuf), 1);\n    let iv = getRandomBytes(12);\n    let ct = await subtle.encrypt(\n      { name: \"AES-GCM\", iv: iv, additionalData: domainBuf, tagLength: 128 },\n      this.secrets.aesKey,\n      padded.buffer,\n    );\n    this.data.kvs[hashed] = {\n      iv: encodeBuffer(iv),\n      ct: encodeBuffer(ct),\n    };\n  }\n  /**\n   * Removes the record with name from the password manager. Returns true\n   * if the record with the specified name is removed, false otherwise.\n   *\n   * Arguments:\n   * name: string\n   * Return Type: Promise<boolean>\n   */\n  async remove(name) {\n    let domainBuf = stringToBuffer(name);\n    let hashedBuf = await subtle.sign(\n      \"HMAC\",\n      this.secrets.domainHmacKey,\n      domainBuf,\n    );\n    let hashed = encodeBuffer(hashedBuf);\n    if (hashed in this.data.kvs) {\n      delete this.data.kvs[hashed];\n      return true;\n    }\n    return false;\n  }\n}\nmodule.exports = { Keychain };\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["file:///home/darrel/School/Cryptography/SemProject1/Proj1_Starter/lib/app/page.jsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport Field from \"./ui/Field\";\nconst { Keychain } = require(\"../password-manager-online.js\");\nconst test = [\n  '{\"kvs\":{\"tVFlxWFM1eTTGEpYsVCBlRuJ3higOf7mhuu9BzOxHgA=\":{\"iv\":\"fdH26skhEWLslxRt\",\"ct\":\"R1HHHQKR+lugNVvM36UVOomUP+m2gQNQ3n5KWjE3bVnxZ82QjcGrTWhhAN73U7LTXZxQ96/UJ5XFIaDCRtMvC30TCVxRHscLvDbM8Yk4sQZ5\"},\"cveydU05Tg/CqPqB4jB9eRuqRW2zedubLv2Wo0+T9aw=\":{\"iv\":\"ZwZNo/vh7tCLloU8\",\"ct\":\"QhRBxA/Y6uxJJsKPCnPl9mu/WxaxNC0QuzDAHrcftk7TasqnvBBWYXjRbrq8nPxSxJ+jq/F6CMwoJ2mBHJ9N83pGJ6wSugZj/6Xeifny5A1J\"},\"CirRlMqSTV6z11WPKyGBVqgN4JuuTp1OqgMadkwJbM8=\":{\"iv\":\"Y3pGjgiDGcAImWrz\",\"ct\":\"lUnEEP/QECE6RvtfKpBsfcFTZRnBrN0ScBER2PkUC3mXX10GQ2GhxnuiGcymU3M2YyyW1zOy2Ia/ldSfgqA3mnkaX/asTdbXu4uEtoDiIMd+\"}},\"salt\":\"lTa5dQBqzQrsJVkXvKA1RA==\",\"verifyTag\":\"bD1cUUcGwJ699e8g7hrcOqpSFyEYMcp4PZDA8fez50A=\"}',\n  \"lIYG+tjo0uXHo5Gp4mtQCxME8imkTDELLuOPOo4ku9M=\",\n];\n\nexport default function Page() {\n  var baseKvs = {};\n  const [search, setSearch] = useState(\"\");\n  const [ready, setReady] = useState(false);\n  const [updated, setUpdated] = useState(false);\n  const [kvs, setKvs] = useState();\n  const [result, setResult] = useState([]);\n  const [addDomain, setAddDomain] = useState([]);\n  const [addPassword, setAddPassword] = useState([]);\n  const [searchFailed, setSearchFailed] = useState(false);\n  const [masterPass, setMasterPass] = useState(\"\");\n  const [masterValid, setMasterValid] = useState(true);\n\n  function handleChange(event) {\n    setSearch(event.target.value);\n  }\n  function handleMasterPass(event) {\n    setMasterPass(event.target.value);\n  }\n  function handleAddDomain(event) {\n    setAddDomain(event.target.value);\n  }\n  function handleAddPassword(event) {\n    setAddPassword(event.target.value);\n  }\n\n  function sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n\n  function deleteEntry(domain) {\n    baseKvs = kvs;\n    baseKvs.remove(domain);\n    setKvs(baseKvs);\n  }\n\n  function addSubmit(event) {\n    event.preventDefault();\n    baseKvs = kvs;\n    console.log(Object.keys(baseKvs.data.kvs).length);\n    baseKvs.set(addDomain, addPassword).then(() => {\n      setKvs(baseKvs);\n      console.log(Object.keys(baseKvs.data.kvs).length);\n      setUpdated(true);\n      setAddPassword(\"\");\n      setAddDomain(\"\");\n      sleep(2000).then(() => {\n        setUpdated(false);\n      });\n    });\n  }\n\n  function searchSubmit(event) {\n    event.preventDefault();\n    kvs.get(search).then((data) => {\n      if (data == null) {\n        setSearchFailed(true);\n        setResult([]);\n      } else {\n        setResult([search, data]);\n        setSearchFailed(false);\n      }\n    });\n    console.log(result);\n  }\n  function auth(event) {\n    event.preventDefault();\n    try {\n      baseKvs = Keychain.load(masterPass, test[0], test[1]).then((data) => {\n        setKvs(data);\n        setReady(true);\n      });\n    } catch {\n      setReady(false);\n      setMasterValid(false);\n    }\n  }\n  useEffect(() => {\n    const decryptAsync = async () => {};\n    decryptAsync();\n  }, []);\n  return ready ? (\n    <main className=\"flex flex-row justify-center w-screen pt-16 space-y-8\">\n      <div className=\"w-1/2 space-y-4\">\n        <h1 className=\"text-3xl font-semibold text-[#4F39F6]\">Secure Vault</h1>\n        <form action=\"\" className=\"space-y-4\" onSubmit={addSubmit}>\n          <h1 className=\"text-2xl font-medium\">Add or update domain</h1>\n          <div className=\"flex flex-row space-x-3\">\n            <div className=\"flex flex-col space-y-2 w-full\">\n              <label htmlFor=\"domain\">Domain:</label>\n              <input\n                type=\"text\"\n                value={addDomain}\n                onChange={handleAddDomain}\n                placeholder=\"Enter new or existing domain\"\n                required\n                className=\"rounded-md px-2 py-2 bg-gray-100 border border-gray-200 w-full\"\n              />\n            </div>\n            <div className=\"flex flex-col space-y-2 w-full\">\n              <label htmlFor=\"password\">Password:</label>\n              <input\n                type=\"password\"\n                value={addPassword}\n                onChange={handleAddPassword}\n                placeholder=\"Enter password\"\n                required\n                className=\"rounded-md px-2 py-2 bg-gray-100 border border-gray-200 w-full\"\n              />\n            </div>\n          </div>\n          <button className=\"text-white bg-[#4F39F6] px-3 py-3 w-full rounded-md\">\n            Add or update domain details\n          </button>\n          {updated ? (\n            <p className=\"text-green-400\">\n              The domain and password was added successfully\n            </p>\n          ) : (\n            <div></div>\n          )}\n        </form>\n        <form action=\"\" onSubmit={searchSubmit}>\n          <h1 className=\"text-2xl font-medium\">Retrieve password</h1>\n          <div className=\"flex flex-col space-y-2\">\n            <label htmlFor=\"domain\">Enter the domain:</label>\n            <div className=\"flex flex-row space-x-3 items-center\">\n              <input\n                type=\"text\"\n                placeholder=\"www.example.com\"\n                required\n                value={search}\n                onChange={handleChange}\n                className=\"rounded-md px-2 py-2 bg-gray-100 border border-gray-200 w-full\"\n              />\n              <button className=\"w-fit text-nowrap px-2 py-3 text-white bg-[#4F39F6] rounded-md\">\n                Get password\n              </button>\n            </div>\n          </div>\n        </form>\n        {searchFailed ? (\n          <p className=\"text-red-500\">\n            No such domain exists in the key value store\n          </p>\n        ) : (\n          <div></div>\n        )}\n        <div>\n          <div className=\"font-semibold flex flex-row text-xl\">\n            <p className=\"w-1/3\">Domain</p>\n            <p className=\"w-2/3\">Password</p>\n          </div>\n          {result.length > 1 ? (\n            <Field\n              domain={result[0]}\n              password={result[1]}\n              deleteEntry={deleteEntry}\n            />\n          ) : (\n            <br />\n          )}\n        </div>\n      </div>\n    </main>\n  ) : (\n    <main className=\"flex flex-row items-center justify-center w-screen h-screen \">\n      <div className=\"shadow-[#4F39F6] border border-[#4F39F6] rounded-xl shadow-lg py-16 px-12 w-3/12\">\n        <h1 className=\"font-bold text-[#4F39F6] text-2xl text-center pb-16 pt-1\">\n          Secure Vault\n        </h1>\n        <form className=\"flex flex-col space-y-8\" onSubmit={auth}>\n          <div className=\"flex flex-col space-y-2\">\n            <label>Master password :</label>\n            <input\n              type=\"password\"\n              className=\"border outline-[#4F39F6] focus:border-[#4F39F6] px-2 py-3 rounded-md\"\n              placeholder=\"Enter master password\"\n              value={masterPass}\n              onChange={handleMasterPass}\n            />\n          </div>\n          <p className=\"text-red-500\">Wrong password. Retry.</p>\n          <button\n            className=\"bg-[#4F39F6] text-white w-full rounded-md py-3\"\n            type=\"submit\"\n          >\n            Unlock Vault\n          </button>\n        </form>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAGA,MAAM,EAAE,QAAQ,EAAE;AAClB,MAAM,OAAO;IACX;IACA;CACD;AAEc,SAAS;IACtB,IAAI,UAAU,CAAC;IACf,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ;IAC9B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC,EAAE;IACvC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC,EAAE;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC,EAAE;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAE/C,SAAS,aAAa,KAAK;QACzB,UAAU,MAAM,MAAM,CAAC,KAAK;IAC9B;IACA,SAAS,iBAAiB,KAAK;QAC7B,cAAc,MAAM,MAAM,CAAC,KAAK;IAClC;IACA,SAAS,gBAAgB,KAAK;QAC5B,aAAa,MAAM,MAAM,CAAC,KAAK;IACjC;IACA,SAAS,kBAAkB,KAAK;QAC9B,eAAe,MAAM,MAAM,CAAC,KAAK;IACnC;IAEA,SAAS,MAAM,EAAE;QACf,OAAO,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;IACtD;IAEA,SAAS,YAAY,MAAM;QACzB,UAAU;QACV,QAAQ,MAAM,CAAC;QACf,OAAO;IACT;IAEA,SAAS,UAAU,KAAK;QACtB,MAAM,cAAc;QACpB,UAAU;QACV,QAAQ,GAAG,CAAC,OAAO,IAAI,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,MAAM;QAChD,QAAQ,GAAG,CAAC,WAAW,aAAa,IAAI,CAAC;YACvC,OAAO;YACP,QAAQ,GAAG,CAAC,OAAO,IAAI,CAAC,QAAQ,IAAI,CAAC,GAAG,EAAE,MAAM;YAChD,WAAW;YACX,eAAe;YACf,aAAa;YACb,MAAM,MAAM,IAAI,CAAC;gBACf,WAAW;YACb;QACF;IACF;IAEA,SAAS,aAAa,KAAK;QACzB,MAAM,cAAc;QACpB,IAAI,GAAG,CAAC,QAAQ,IAAI,CAAC,CAAC;YACpB,IAAI,QAAQ,MAAM;gBAChB,gBAAgB;gBAChB,UAAU,EAAE;YACd,OAAO;gBACL,UAAU;oBAAC;oBAAQ;iBAAK;gBACxB,gBAAgB;YAClB;QACF;QACA,QAAQ,GAAG,CAAC;IACd;IACA,SAAS,KAAK,KAAK;QACjB,MAAM,cAAc;QACpB,IAAI;YACF,UAAU,SAAS,IAAI,CAAC,YAAY,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;gBAC1D,OAAO;gBACP,SAAS;YACX;QACF,EAAE,OAAM;YACN,SAAS;YACT,eAAe;QACjB;IACF;IACA,IAAA,kNAAS,EAAC;QACR,MAAM,eAAe,WAAa;QAClC;IACF,GAAG,EAAE;IACL,OAAO,sBACL,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAAwC;;;;;;8BACtD,8OAAC;oBAAK,QAAO;oBAAG,WAAU;oBAAY,UAAU;;sCAC9C,8OAAC;4BAAG,WAAU;sCAAuB;;;;;;sCACrC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAM,SAAQ;sDAAS;;;;;;sDACxB,8OAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU;4CACV,aAAY;4CACZ,QAAQ;4CACR,WAAU;;;;;;;;;;;;8CAGd,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAM,SAAQ;sDAAW;;;;;;sDAC1B,8OAAC;4CACC,MAAK;4CACL,OAAO;4CACP,UAAU;4CACV,aAAY;4CACZ,QAAQ;4CACR,WAAU;;;;;;;;;;;;;;;;;;sCAIhB,8OAAC;4BAAO,WAAU;sCAAsD;;;;;;wBAGvE,wBACC,8OAAC;4BAAE,WAAU;sCAAiB;;;;;iDAI9B,8OAAC;;;;;;;;;;;8BAGL,8OAAC;oBAAK,QAAO;oBAAG,UAAU;;sCACxB,8OAAC;4BAAG,WAAU;sCAAuB;;;;;;sCACrC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAM,SAAQ;8CAAS;;;;;;8CACxB,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,MAAK;4CACL,aAAY;4CACZ,QAAQ;4CACR,OAAO;4CACP,UAAU;4CACV,WAAU;;;;;;sDAEZ,8OAAC;4CAAO,WAAU;sDAAiE;;;;;;;;;;;;;;;;;;;;;;;;gBAMxF,6BACC,8OAAC;oBAAE,WAAU;8BAAe;;;;;yCAI5B,8OAAC;;;;;8BAEH,8OAAC;;sCACC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAE,WAAU;8CAAQ;;;;;;8CACrB,8OAAC;oCAAE,WAAU;8CAAQ;;;;;;;;;;;;wBAEtB,OAAO,MAAM,GAAG,kBACf,8OAAC,8HAAK;4BACJ,QAAQ,MAAM,CAAC,EAAE;4BACjB,UAAU,MAAM,CAAC,EAAE;4BACnB,aAAa;;;;;iDAGf,8OAAC;;;;;;;;;;;;;;;;;;;;;6BAMT,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA2D;;;;;;8BAGzE,8OAAC;oBAAK,WAAU;oBAA0B,UAAU;;sCAClD,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;8CAAM;;;;;;8CACP,8OAAC;oCACC,MAAK;oCACL,WAAU;oCACV,aAAY;oCACZ,OAAO;oCACP,UAAU;;;;;;;;;;;;sCAGd,8OAAC;4BAAE,WAAU;sCAAe;;;;;;sCAC5B,8OAAC;4BACC,WAAU;4BACV,MAAK;sCACN;;;;;;;;;;;;;;;;;;;;;;;AAOX"}}]
}